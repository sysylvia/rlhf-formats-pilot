<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peer Prediction - RLHF Annotation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .instructions {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #4CAF50;
        }
        
        .bonus-info {
            background: #fff3cd;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #ffc107;
            font-size: 14px;
        }
        
        .bonus-info strong {
            color: #856404;
        }
        
        .prompt-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .prompt-text {
            font-size: 16px;
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
        }
        
        .responses {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .response {
            border: 2px solid #e0e0e0;
            padding: 20px;
            border-radius: 8px;
            background: white;
            transition: border-color 0.2s;
        }
        
        .response:hover {
            border-color: #2196F3;
        }
        
        .response.selected {
            border-color: #4CAF50;
            background: #f1f8f4;
        }
        
        .response-label {
            font-weight: bold;
            color: #2196F3;
            margin-bottom: 10px;
            font-size: 14px;
            text-transform: uppercase;
        }
        
        .response-text {
            color: #333;
            line-height: 1.6;
        }
        
        .selection-area {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .question-section {
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .question {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        
        .radio-group {
            display: flex;
            gap: 30px;
            margin-bottom: 20px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            transition: all 0.2s;
        }
        
        .radio-option:hover {
            border-color: #2196F3;
            background: #f5f5f5;
        }
        
        .radio-option input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .radio-option label {
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
        }
        
        .prediction-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .prediction-explanation {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 6px;
            border-left: 3px solid #2196F3;
        }
        
        .slider-container {
            margin-bottom: 15px;
        }
        
        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
            color: #666;
        }
        
        .slider-wrapper {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        input[type="range"] {
            flex: 1;
            height: 8px;
            background: linear-gradient(to right, #2196F3 0%, #2196F3 50%, #ddd 50%, #ddd 100%);
            outline: none;
            border-radius: 4px;
        }
        
        .prediction-value {
            font-weight: bold;
            font-size: 24px;
            color: #2196F3;
            min-width: 60px;
            text-align: center;
        }
        
        .prediction-visual {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .prediction-bar {
            flex: 1;
            height: 40px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
        }
        
        .prediction-bar.response-a {
            background: #4CAF50;
        }
        
        .prediction-bar.response-b {
            background: #2196F3;
        }
        
        .confidence-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }
        
        .confidence-label {
            font-weight: 500;
            margin-bottom: 10px;
            display: block;
        }
        
        .confidence-slider {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .confidence-value {
            font-weight: bold;
            font-size: 18px;
            color: #2196F3;
            min-width: 40px;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }
        
        button {
            padding: 12px 30px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-submit {
            background: #4CAF50;
            color: white;
        }
        
        .btn-submit:hover:not(:disabled) {
            background: #45a049;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .btn-submit:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .btn-skip {
            background: #f44336;
            color: white;
        }
        
        .btn-skip:hover {
            background: #da190b;
        }
        
        .progress {
            background: white;
            padding: 10px 20px;
            border-radius: 6px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .timer {
            font-weight: bold;
            color: #2196F3;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ðŸŽ¯ Peer Prediction Task</h1>
        <p>Compare responses AND predict what others will choose</p>
    </div>
    
    <div class="progress">
        <span>Progress: <strong id="current-task">1</strong> / <strong id="total-tasks">100</strong></span>
        <span class="timer">Time: <span id="timer">00:00</span></span>
    </div>
    
    <div class="bonus-info">
        <strong>ðŸ’° Bonus Opportunity:</strong> You can earn bonus payment based on the accuracy of your prediction! 
        The more accurately you predict what other annotators will choose, the higher your bonus.
    </div>
    
    <div class="instructions">
        <strong>Instructions:</strong> 
        <ol style="margin-left: 20px; margin-top: 10px;">
            <li>Read the prompt and compare the two responses</li>
            <li>Select which response is better (A or B)</li>
            <li>Predict what percentage of OTHER annotators will choose Response A</li>
            <li>Indicate your confidence level</li>
        </ol>
    </div>
    
    <div class="prompt-section">
        <h3>Prompt:</h3>
        <div class="prompt-text" id="prompt-text">
            [Example] What are the main differences between classical and operant conditioning?
        </div>
    </div>
    
    <div class="responses">
        <div class="response" id="response-a">
            <div class="response-label">Response A</div>
            <div class="response-text" id="text-a">
                [Example Response A] Classical conditioning involves associating an involuntary response with a stimulus, 
                while operant conditioning associates a voluntary behavior with a consequence. Classical conditioning was 
                discovered by Pavlov, while operant conditioning was developed by Skinner.
            </div>
        </div>
        
        <div class="response" id="response-b">
            <div class="response-label">Response B</div>
            <div class="response-text" id="text-b">
                [Example Response B] The main difference is that classical conditioning focuses on automatic, reflexive 
                behaviors, whereas operant conditioning deals with voluntary behaviors. In classical conditioning, the 
                learner is passive, but in operant conditioning, the learner is active and operates on the environment.
            </div>
        </div>
    </div>
    
    <div class="selection-area">
        <div class="question-section">
            <div class="question">1. Which response is better?</div>
            
            <div class="radio-group">
                <div class="radio-option">
                    <input type="radio" id="select-a" name="choice" value="A">
                    <label for="select-a">Response A is better</label>
                </div>
                
                <div class="radio-option">
                    <input type="radio" id="select-b" name="choice" value="B">
                    <label for="select-b">Response B is better</label>
                </div>
            </div>
        </div>
        
        <div class="prediction-section">
            <div class="question">2. What percentage of OTHER annotators will choose Response A?</div>
            
            <div class="prediction-explanation">
                ðŸ’¡ <strong>Think about this:</strong> Even if you chose Response B, many others might choose Response A. 
                Or vice versa. Your prediction should reflect what you think the GROUP will say, not just your own choice.
            </div>
            
            <div class="slider-container">
                <div class="slider-labels">
                    <span>0% (Everyone chooses B)</span>
                    <span>50% (Split evenly)</span>
                    <span>100% (Everyone chooses A)</span>
                </div>
                
                <div class="slider-wrapper">
                    <span>0%</span>
                    <input type="range" id="prediction" min="0" max="100" value="50" step="5">
                    <span>100%</span>
                    <div class="prediction-value" id="prediction-value">50%</div>
                </div>
            </div>
            
            <div class="prediction-visual">
                <div class="prediction-bar response-a" id="bar-a" style="flex: 1;">
                    A: <span id="percent-a">50%</span>
                </div>
                <div class="prediction-bar response-b" id="bar-b" style="flex: 1;">
                    B: <span id="percent-b">50%</span>
                </div>
            </div>
        </div>
        
        <div class="confidence-section">
            <label class="confidence-label" for="confidence">How confident are you overall?</label>
            <div class="confidence-slider">
                <span>Not confident</span>
                <input type="range" id="confidence" min="1" max="5" value="3" step="1">
                <span>Very confident</span>
                <span class="confidence-value" id="confidence-value">3</span>
            </div>
        </div>
        
        <div class="buttons">
            <button class="btn-skip" onclick="skipTask()">Skip</button>
            <button class="btn-submit" id="submit-btn" disabled onclick="submitResponse()">Submit</button>
        </div>
    </div>
    
    <script>
        // Timer
        let startTime = Date.now();
        setInterval(() => {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            document.getElementById('timer').textContent = 
                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }, 1000);
        
        // Prediction slider
        const predictionSlider = document.getElementById('prediction');
        const predictionValue = document.getElementById('prediction-value');
        const percentA = document.getElementById('percent-a');
        const percentB = document.getElementById('percent-b');
        const barA = document.getElementById('bar-a');
        const barB = document.getElementById('bar-b');
        
        predictionSlider.addEventListener('input', (e) => {
            const value = parseInt(e.target.value);
            predictionValue.textContent = `${value}%`;
            percentA.textContent = `${value}%`;
            percentB.textContent = `${100 - value}%`;
            
            // Update bar widths
            barA.style.flex = value;
            barB.style.flex = 100 - value;
            
            // Update range background gradient
            const percent = value;
            e.target.style.background = `linear-gradient(to right, #2196F3 0%, #2196F3 ${percent}%, #ddd ${percent}%, #ddd 100%)`;
        });
        
        // Confidence slider
        document.getElementById('confidence').addEventListener('input', (e) => {
            document.getElementById('confidence-value').textContent = e.target.value;
        });
        
        // Radio button handling
        const radioButtons = document.querySelectorAll('input[name="choice"]');
        const submitBtn = document.getElementById('submit-btn');
        const responseA = document.getElementById('response-a');
        const responseB = document.getElementById('response-b');
        
        radioButtons.forEach(radio => {
            radio.addEventListener('change', () => {
                submitBtn.disabled = false;
                
                // Visual feedback
                responseA.classList.remove('selected');
                responseB.classList.remove('selected');
                
                if (radio.value === 'A') {
                    responseA.classList.add('selected');
                } else if (radio.value === 'B') {
                    responseB.classList.add('selected');
                }
            });
        });
        
        // Submission
        function submitResponse() {
            const selected = document.querySelector('input[name="choice"]:checked');
            const prediction = parseInt(document.getElementById('prediction').value);
            const confidence = document.getElementById('confidence').value;
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            
            if (!selected) {
                alert('Please select a response');
                return;
            }
            
            const data = {
                choice: selected.value,
                prediction_pct_choose_A: prediction,
                confidence: parseInt(confidence),
                timeSeconds: elapsed,
                timestamp: new Date().toISOString()
            };
            
            console.log('Submitted:', data);
            // In real implementation, send to backend
            
            alert(`Submitted!\nChoice: ${selected.value}\nPrediction: ${prediction}% will choose A\nConfidence: ${confidence}\nTime: ${elapsed}s`);
        }
        
        function skipTask() {
            if (confirm('Are you sure you want to skip this task?')) {
                console.log('Task skipped');
                alert('Task skipped');
            }
        }
    </script>
</body>
</html>